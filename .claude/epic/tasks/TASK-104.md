# TASK-104: [HIGH] Audit encryption keys in source code and documentation

**Status:** Pending
**Priority:** High
**Assignee:** Unassigned
**Created:** 2026-02-05
**Updated:** 2026-02-05
**Tags:** legal, security, keys, compliance
**Agent:** Themis

---

## Description

**Source:** Themis Legal/Compliance Review

**Problem:** The previous review (TASK-011) marked hardcoded encryption keys as resolved, but a current audit shows keys remain in source code and documentation. This needs verification and potential remediation.

**Locations with Keys:**

1. **CPSKeys.swift** (Lines 16-56):
   - `businessRadioDESKey`: Triple DES key (24 bytes)
   - `businessRadioDESIV`: Triple DES IV (8 bytes)
   - `adminKey`: License validation key (28 chars)
   - `mototrboCipherKey`: DES key (8 bytes)
   - `mototrboCipherIV`: IV (8 bytes)

2. **XNLEncryption.swift** (Lines 19-30):
   - TEA key: 16-byte authentication key
   - TEA delta: Custom constant (0x790AB771)

3. **XPR_PROTOCOL_FINDINGS.md** (Lines 76-94):
   - TEA key bytes documented
   - Delta constant documented

**Options for Remediation:**

1. **Environment Variables** - Load keys from environment (breaks offline use)
2. **External Config File** - User provides keys in config (adds friction)
3. **Document Justification** - Keep keys but add legal justification for interoperability
4. **Obfuscation** - Not recommended (security through obscurity)

**Recommended Approach:**
Given the interoperability purpose, Option 3 may be appropriate but requires:
- Clear documentation of interoperability purpose
- Statement that keys are publicly documented elsewhere (Moto.Net references)
- Acknowledgment in LEGAL.md

---

## Acceptance Criteria

- [ ] Complete audit of all key locations (source code and docs)
- [ ] Decision documented on key handling approach
- [ ] If keeping keys: Legal justification documented in LEGAL.md
- [ ] If externalizing: Migration implemented
- [ ] README includes note about key sources (for transparency)
- [ ] Verify TASK-011 closure was accurate

---

## Context

**Reference:** The Moto.Net README states:
> "Those constants aren't in the repo. Ideally this should be an exercise for you to figure out how to derive them."

This project takes a different approach by including keys directly. This difference in approach needs legal review.

---

## Blockers

- TASK-100 (LEGAL.md) should inform the decision on key handling

---

*Generated by Themis Compliance Review - 2026-02-05*
